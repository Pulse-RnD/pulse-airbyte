documentationUrl: https://docs.airbyte.com/integrations/sources/google-directory-v2
connectionSpecification:
  $schema: http://json-schema.org/draft-07/schema#
  title: Google Directory V2 Spec
  type: object
  required:
    - credentials_json
    - admin_email
  additionalProperties: true
  properties:
    credentials_json:
      title: Service Account Key
      description: "The contents of the JSON service account key. See the <a href=\"https://developers.google.com/admin-sdk/directory/v1/guides/delegation\">docs</a> for more information on how to generate this key."
      type: string
      order: 0
      examples:
        - "json content of your key file"
      airbyte_secret: true

    admin_email:
      title: Admin Email
      description: "The email of the workspace admin the service account is acting on behalf of"
      type: string
      order: 1
      examples:
        - "admin@yourcompany.com"
      pattern: "^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$"

    customer_id:
      title: Customer ID
      description: "The Google Workspace customer ID to use. Defaults to 'my_customer' which means the customer the service account belongs to."
      type: string
      default: "my_customer"
      order: 2
      examples:
        - "C01234567"
        - "my_customer"

streams:
  - name: users
    supported_sync_modes:
      - full_refresh
      - incremental
    source_defined_cursor: true
    json_schema:
      $schema: http://json-schema.org/draft-07/schema#
      type: object
      properties:
        id:
          type: string
          description: "The unique ID for the user"
        primaryEmail:
          type: string
          description: "The user's primary email address"
        name:
          type: object
          properties:
            givenName:
              type: string
            familyName:
              type: string
            fullName:
              type: string
        isAdmin:
          type: boolean
          description: "Whether the user is a super admin"
        isDelegatedAdmin:
          type: boolean
        creationTime:
          type: string
          format: date-time
        lastLoginTime:
          type: string
          format: date-time
        suspended:
          type: boolean
        archived:
          type: boolean
        changePasswordAtNextLogin:
          type: boolean
        ipWhitelisted:
          type: boolean
        emails:
          type: array
          items:
            type: object
            properties:
              address:
                type: string
              type:
                type: string
        customerId:
          type: string
        orgUnitPath:
          type: string
        isMailboxSetup:
          type: boolean
        includeInGlobalAddressList:
          type: boolean

  - name: groups
    supported_sync_modes:
      - full_refresh
    source_defined_cursor: false
    json_schema:
      $schema: http://json-schema.org/draft-07/schema#
      type: object
      properties:
        id:
          type: string
          description: "The unique ID of the group"
        email:
          type: string
          description: "The group's email address"
        name:
          type: string
          description: "The group's display name"
        description:
          type: string
          description: "Description of the group"
        directMembersCount:
          type: integer
          description: "Number of direct members in the group"
        adminCreated:
          type: boolean
          description: "Whether this group was created by an administrator"
        aliases:
          type: array
          items:
            type: string
          description: "List of group's email aliases"
        nonEditableAliases:
          type: array
          items:
            type: string
        allowExternalMembers:
          type: boolean
        allowWebPosting:
          type: boolean
        customerId:
          type: string
        organizationUnit:
          type: string

  - name: oauth_apps_by_user
    supported_sync_modes:
      - full_refresh
    source_defined_cursor: false
    json_schema:
      $schema: http://json-schema.org/draft-07/schema#
      type: object
      properties:
        userId:
          type: string
          description: "The unique ID of the user"
        userEmail:
          type: string
          description: "The email address of the user"
        oauthApps:
          type: array
          items:
            type: object
            properties:
              appId:
                type: string
                description: "The unique ID of the OAuth app"
              appName:
                type: string
                description: "The name of the OAuth app"
              scopes:
                type: array
                items:
                  type: string
                description: "The scopes required by the OAuth app"
              anonymous:
                type: boolean
                description: "Whether the OAuth app is an anonymous application"
              nativeApp:
                type: boolean
                description: "Whether the OAuth app is a native application"
              issuedTime:
                type: string
                format: date-time
                description: "The time when the OAuth app was created"
              lastAccessTime:
                type: string
                description: "The last time the OAuth app was accessed"
              instalationType:
                type: string
                description: "The type of installation for the OAuth app (e.g., user-specific, domain-wide, third-party)"
              appType:
                type: string
                description: "The type of the app (in this case, 'oauth')"
              status:
                type: ["string", "null"]
                description: "The status of the OAuth app (if available)"
              etag:
                type: ["string", "null"]
                description: "The etag of the OAuth app (if available)"